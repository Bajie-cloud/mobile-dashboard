# 移动端老板报表数据看板技术架构文档

## 1. Architecture design

```mermaid
graph TD
    A[用户浏览器] --> B[React H5应用]
    B --> C[模拟数据层]
    B --> D[ECharts图表库]
    B --> E[Ant Design Mobile]
    C --> F[本地JSON数据文件]

    subgraph "前端应用层"
        B
        D
        E
    end

    subgraph "数据层"
        C
        F
    end

    subgraph "部署层"
        G[静态网站托管]
        H[CDN加速]
    end

    B --> G
    G --> H
```

## 2. Technology Description

* Frontend: React\@18 + TypeScript\@5 + Vite\@5 + Ant Design Mobile\@5 + ECharts\@5 + TailwindCSS\@3

* 数据: 本地模拟数据 (Mock Data JSON文件)

* 状态管理: Zustand\@4

* 路由: React Router\@6

* 部署: 静态网站部署 (Vercel/Netlify/GitHub Pages)

## 3. Route definitions

| Route     | Purpose              |
| --------- | -------------------- |
| /         | 数据看板主页，展示六大业务板块的核心指标 |
| /overview | 核心业绩概览详情页，深入查看KPI数据  |
| /channel  | 渠道分析详情页，堂食外卖数据钻取     |
| /region   | 区域分析详情页，各省份门店表现钻取    |
| /product  | 菜品分析详情页，TOP菜品和套餐详情   |
| /store    | 门店梯度表现详情页，门店排名和对比    |
| /alert    | 异常预警详情页，预警规则和异常门店列表  |

## 4. 数据结构定义

### 4.1 模拟数据服务

数据通过本地JSON文件和模拟数据服务提供：

**数据获取方式**

```typescript
// 从本地JSON文件加载数据
import corePerformanceData from '@/data/corePerformance.json';
import channelAnalysisData from '@/data/channelAnalysis.json';
import alertRecordsData from '@/data/alertRecords.json';

// 模拟异步数据获取
const getCorePerformanceData = async (date: string) => {
  return new Promise((resolve) => {
    setTimeout(() => {
      const data = corePerformanceData.find(item => item.date === date);
      resolve(data);
    }, 300); // 模拟网络延迟
  });
};
```

### 4.2 TypeScript类型定义

```typescript
// 核心业绩数据类型
interface CorePerformance {
  id: string;
  date: string;
  active_stores: number;
  active_stores_change: number;
  total_revenue: number;
  total_revenue_change_rate: number;
  avg_store_revenue: number;
  avg_store_revenue_change_rate: number;
  created_at: string;
}

// 渠道分析数据类型
interface ChannelAnalysis {
  id: string;
  date: string;
  dine_in_ratio: number;
  takeout_ratio: number;
  dine_in_traffic: number;
  dine_in_traffic_change_rate: number;
  dine_in_avg_price: number;
  dine_in_avg_price_change: number;
  takeout_orders: number;
  takeout_orders_change_rate: number;
  takeout_avg_price: number;
  takeout_avg_price_change: number;
}

// 异常预警数据类型
interface AlertRecord {
  id: string;
  store_id: string;
  store_name: string;
  alert_type: 'revenue_drop' | 'traffic_drop' | 'order_drop' | 'takeout_ratio_high' | 'takeout_ratio_low';
  alert_value: number;
  threshold: number;
  is_active: boolean;
  created_at: string;
}
```

## 5. 模拟数据文件结构

### 5.1 数据文件组织

```
src/
├── data/
│   ├── corePerformance.json      # 核心业绩数据
│   ├── channelAnalysis.json      # 渠道分析数据
│   ├── regionAnalysis.json       # 区域分析数据
│   ├── productSales.json         # 菜品销售数据
│   ├── storeRanking.json         # 门店排名数据
│   ├── alertRecords.json         # 异常预警数据
│   └── stores.json               # 门店基础信息
```

### 5.2 数据文件示例

**核心业绩数据 (corePerformance.json)**

```json
[
  {
    "date": "2024-01-15",
    "activeStores": 1250,
    "activeStoresChange": 8,
    "totalRevenue": 2850000,
    "totalRevenueChangeRate": 12.5,
    "avgStoreRevenue": 2280,
    "avgStoreRevenueChangeRate": 8.3
  }
]
```

**渠道分析数据 (channelAnalysis.json)**

```json
[
  {
    "date": "2024-01-15",
    "dineInRatio": 65.2,
    "takeoutRatio": 34.8,
    "dineInTraffic": 45680,
    "dineInTrafficChangeRate": 15.2,
    "dineInAvgPrice": 42.5,
    "dineInAvgPriceChange": 2.8,
    "takeoutOrders": 18950,
    "takeoutOrdersChangeRate": 22.1,
    "takeoutAvgPrice": 52.3,
    "takeoutAvgPriceChange": 3.2
  }
]
```

**异常预警数据 (alertRecords.json)**

```json
[
  {
    "id": "alert_001",
    "storeId": "store_001",
    "storeName": "北京朝阳店",
    "alertType": "revenue_drop",
    "alertValue": -52.3,
    "threshold": -50.0,
    "isActive": true,
    "createdAt": "2024-01-15T08:30:00Z"
  }
]
```

